# ==========================================
# API 应用环境变量配置示例
# ==========================================
#
# 【使用说明】
# 1. 复制此文件为 .env.local：
#    cp .env.example .env.local
# 2. 填写实际的配置值
# 3. .env.local 不会被提交到 Git（已在 .gitignore 中）
#
# 【环境变量优先级】（从高到低）
# .env.{NODE_ENV}.local > .env.{NODE_ENV} > .env.local > .env
#

# ==========================================
# 数据库配置 (PostgreSQL)
# ==========================================
# 连接字符串格式：postgresql://用户名:密码@主机:端口/数据库名?参数
#
# 本地开发（Docker）示例：
# DATABASE_URL=postgresql://postgres:postgres@localhost:5432/reimbursement
#
# Supabase 示例：
# DATABASE_URL=postgresql://postgres:[密码]@db.[项目ID].supabase.co:5432/postgres?sslmode=require
#
# Neon 示例：
# DATABASE_URL=postgresql://[用户名]:[密码]@[主机].neon.tech/[数据库]?sslmode=require
DATABASE_URL=postgresql://user:password@localhost:5432/reimbursement

# ==========================================
# S3 对象存储配置 (Cloudflare R2 或兼容服务)
# ==========================================
# R2 端点格式：https://[账户ID].r2.cloudflarestorage.com
S3_ENDPOINT=https://your-account-id.r2.cloudflarestorage.com
S3_REGION=auto
S3_ACCESS_KEY=your-access-key
S3_SECRET_KEY=your-secret-key
S3_BUCKET=reimbursement

# S3 公开访问 URL（可选，通过自定义域名访问）
# 如果配置了 R2 自定义域名，填写此项
S3_PUBLIC_BASE_URL=https://s3.yourdomain.com

# ==========================================
# JWT 配置
# ==========================================
# 【重要】生产环境必须使用强密钥（至少 32 字符）
# 生成密钥命令：
#   openssl rand -base64 32
#   或
#   node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"

# JWT 访问令牌密钥（用于短期访问令牌）
JWT_ACCESS_SECRET=change-me-to-a-secure-random-secret-key-at-least-32-chars

# JWT 刷新令牌密钥（用于长期刷新令牌，必须与 ACCESS_SECRET 不同）
JWT_REFRESH_SECRET=change-me-to-another-secure-random-secret-key-32-chars

# JWT 令牌有效期
# 格式：数字+单位（s=秒, m=分钟, h=小时, d=天）
JWT_ACCESS_TTL=15m      # 访问令牌 15 分钟
JWT_REFRESH_TTL=30d     # 刷新令牌 30 天

# ==========================================
# 应用配置
# ==========================================
# API 服务端口（开发环境）
PORT=8787

# 是否启动内置 Worker（后台任务）
# 生产环境部署 API+Worker 时设置为 true
START_WORKER=true

# 日志级别（debug/info/warn/error）
LOG_LEVEL=info

# ==========================================
# CORS 配置
# ==========================================
# 生产环境必须显式配置允许的前端域名（逗号分隔）
# 例：CORS_ALLOWED_ORIGINS=https://your-vercel-domain.vercel.app,https://yourdomain.com
CORS_ALLOWED_ORIGINS=

# ==========================================
# 认证限流配置
# ==========================================
# 窗口时间（毫秒）与最大请求数
AUTH_RATE_LIMIT_WINDOW_MS=60000
AUTH_RATE_LIMIT_MAX=10

# ==========================================
# 上传限制
# ==========================================
# 最大上传大小（字节），默认 10MB
UPLOAD_MAX_BYTES=10485760
# 允许的 MIME 类型（逗号分隔）
UPLOAD_ALLOWED_MIME_TYPES=image/jpeg,image/png,application/pdf
# 允许的文件扩展名（逗号分隔）
UPLOAD_ALLOWED_EXTENSIONS=jpg,jpeg,png,pdf
